function [ out ] = TRSforwardKinematic( phi )
%TRSforwardKinematic - Short description
%   Long descriotion with examples if nessesary.
%
%   Info:
%   Designed by:    Mirko Schimkat
%   Date created:   01.01.2016
%   Last modified:  07.01.2016
%   Change Log:

%% Parameters
d1 = 0.089159;
d4 = 0.10915;
d5 = 0.09465;
d6 = 0.0823;

a2 = -0.4250;
a3 = -0.39225;

%% Trigonometic functions
c1      = cosd(phi(1));
c2      = cosd(phi(2));
c3      = cosd(phi(3));
c4      = cosd(phi(4));
c5      = cosd(phi(5));
c6      = cosd(phi(6));
c234    = cosd(phi(2) + phi(3) + phi(4));


s1      = sind(phi(1));
s2      = sind(phi(2));
s3      = sind(phi(3));
s4      = sind(phi(4));
s5      = sind(phi(5));
s6      = sind(phi(6));

s234    = sind(phi(2) + phi(3) + phi(4));


%% Functiions
nx  = c6*(s1*s5 + ((c1*c234 - s1*s234)*c5)/2 ... 
    + ((c1*c234 + s1*s234)*c5)/2) ...
    - (s6*((s1*c234 + c1*s234) - (s1*c234 - c1*s234)))/2;

ny  = c6*(((s1*c234 + c1*s234)*c5)/2 ...
    - c1*s5 + ...
    + ((s1*c234 - c1*s234)*c5)/2) ...
    + s6*((c1*c234 - s1*s234)/2 ...
    - (c1*c234 + s1*s234)/2);

nz  = (s234*c6 + c234*s6)/2 ... 
    + s234*c5*c6 ...
    - (s234*c6 - c234*s6)/2;

ox  = -(c6*((s1*c234 + c1*s234) ...
    - (s1*c234 - c1*s234)))/2 ...
    - s6*(s1*s5 + ((c1*c234 - s1*s234)*c5)/2 ...
    + ((c1*c234 + s1*s234)*c5)/2:0);

oy  = c6*((c1*c234 - s1*s234)/2 ...
    - (c1*c234 + s1*s234)/2) ...
    - s6*(((s1*c234 + c1*s234)*c5)/2 ...
    - c1*s5 ...
    + ((s1*c234 - c1*s234)*c5)/2);

oz  = (c234*c6 + s234*s6)/2 ... 
    + (c234*c6 - s234*s6)/2 ...
    - s234*c5*s6;

ax  = c5*s1 ...
    - ((c1*c234 - s1*s234)*s5)/2 ...
    - ((c1*c234 + s1*s234)*s5)/2;

ay  = - c1*c5 ...
      - ((s1*c234 + c1*s234)*s5)/2 ...
      + ((c1*s234 - s1*c234)*s5)/2;
  
az  = (c234*c5 - s234*s5)/2 ...
    - (c234*c5 + s234*s5)/2;

px  = - (d5*(s1*c234 - c1*s234))/2 ...
      + (d5*(s1*c234 + c1*s234))/2 ...
      + d4*s1 ...
      - (d6*(c1*c234 - s1*s234)*s5)/2 ...
      - (d6*(c1*c234 + s1*s234)*s5)/2 ...
      + a2*c1*c2 ... 
      + d6*c5*s1 ...
      + a3*c1*c2*c3 ...
      - a3*c1*s2*s3;

py  = - (d5*(c1*c234 - s1*s234))/2 ...
      + (d5*(c1*c234 + s1*s234))/2 ...
      - d4*c1 ...
      - (d6*(s1*c234 + c1*s234)*s5)/2 ...
      - (d6*(s1*c234 - c1*s234)*s5)/2 ... 
      - d6*c1*c5 ...
      + a2*c2*s1 ...
      + a3*c2*c3*s1 ...
      - a3*s1*s2*s3;
  
pz  =  d1 ...
    + (d6*(c234*c5 - s234*s5))/2 ... 
    + a3*(s2*c3 + c2*s3) ...
    + a2*s2 ...
    - (d6*(c234*c5 + s234*s5))/2 ...
    - d5*c234;

out = [ nx ox ax px;
        ny oy ay py;
        nz oz az pz;
        0  0  0  1 ];

end

